% Work for test...

clc; clear; close all;

home_x = 0.175 + 1.2305 + 0.085;
home_z = 0.495 + 1.095 + 0.175;

M = [0, 0, 1, home_x; 0, 1, 0, 0; -1, 0, 0, home_z; 0, 0, 0, 1];

S1 = [0; 0; 1; 0; 0; 0];

S2o = [0; 1; 0;];
S2p = [0.175; 0; 0.495];
S2 = [S2o; cross(-S2o, S2p)];

S3o = [0; 1; 0;];
S3p = [0.175; 0;  0.495 + 1.095];
S3 = [S3o; cross(-S3o, S3p)];

S4o = [1; 0; 0;];
S4p = [0.175; 0;  home_z];
S4 = [S4o; cross(-S4o, S4p)];

S5o = [0; 1; 0;];
S5p = [0.175+1.2305; 0;  home_z];
S5 = [S5o; cross(-S5o, S5p)];

S6o = [1; 0; 0;];
S6p = [home_x; 0;  home_z];
S6 = [S6o; cross(-S6o, S6p)];

B1 = [0;0;1; cross(-[0;0;1], [0; 0; 0])];
B2 = [0;1;0; cross(-[0;1;0], [0; 0; -0.085])];
B3 = [0;0;1; cross(-[0;0;1], [0; 0; -0.085-1.2305])];
B4 = [0;1;0; cross(-[0;1;0], [0.175; 0;-0.085-1.2305])];
B5 = [0;1;0; cross(-[0;1;0], [0.175+1.095; 0;-0.085-1.2305])];
B6 = [-1;0;0; cross(-[-1;0;0],[0.175+1.095; 0;-0.085-1.2305-0.175])];

BList = [B6, B5, B4, B3, B2, B1];

T_astro = [0, 1, 0, -0.97; 0.2, 0, 1, 0.69; 1, 0, 0.2, 2.3; 0, 0, 0, 1];

T_pos1 = [0.0321, 0.5024, 0.864, -0.3051; 0.2751, -0.8355, 0.4756, 1.1485; 0.9609, 0.2224, -0.1650, 2.3195; 0, 0, 0, 1];
T_pos2 = [-0.9777, 0.1944, 0.0790, -1.8302; -0.1193, -0.2053, -0.9714, -0.0826; -0.1726, -0.9592, 0.2239, 1.7019; 0, 0, 0, 1];
T_pos3 = [-1, 0, 0.0, 0; 0, 1, 0, 1.1243; 0, 0, -1, -0.0462; 0, 0, 0, 1];


SList = [S1, S2, S3, S4, S5, S6];

 % Q1
eomg = 0.01;
ev = 0.001;
theta_0_s = [2;0;0;0;0;0];
[s_1, success] = IKinSpace(SList, M, T_pos1, theta_0_s, eomg, ev);
theta_0_s = [-3;0;0;0;0;0];
[s_2, success] = IKinSpace(SList, M, T_pos2, theta_0_s, eomg, ev);
theta_0_s = [1.5;0;0;0;0;0];
[s_3, success] = IKinSpace(SList, M, T_pos3, theta_0_s, eomg, ev);
% theta_0_b = [1.5;0;0;0;0;0];
% [s_3, success] = IKinBody(BList, M, T_pos3, theta_0_b, eomg, ev);


T = [0;10;0;0;0;0];

j1 = JacobianSpace(SList,s_1);

torques = transpose(j1)*T

j3 = JacobianBody(BList,s_3);

v = [0;0;0;5;0;0];

inv(j3)*v











